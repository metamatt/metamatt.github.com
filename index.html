
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Step 2 is the hard part.</title>
  <meta name="author" content="Matt Ginzton">

  
  <meta name="description" content="Last night I installed the OS X 10.8.3 update on my laptop (updating from 10.8.2). This morning,
upon plugging my laptop into the external &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.metamatt.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Step 2 is the hard part." type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-19563060-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Step 2 is the hard part.</a></h1>
  
    <h2>Matt Ginzton writes here.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:blog.metamatt.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/20/apple-is-getting-really-aggressive-about-this-sleepdelay-thing/">Apple Is Getting Really Aggressive About This Sleepdelay Thing</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-20T09:01:00-07:00" pubdate data-updated="true">Mar 20<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/03/20/apple-is-getting-really-aggressive-about-this-sleepdelay-thing/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last night I installed the OS X 10.8.3 update on my laptop (updating from 10.8.2). This morning,
upon plugging my laptop into the external Thunderbolt display as I always do, and it didn&rsquo;t wake
up when I opened the lid, nor when I started tapping on the external keyboard.</p>

<p><a href="http://blog.metamatt.com/blog/2013/02/21/speedy-resume/">As I noted before</a>, a retina MBP
(or MacBook Air) that doesn&rsquo;t immediately wake when you open the lid is annoying not only because
it slows you down, but because Apple&rsquo;s removed all the battery indicator buttons, and there&rsquo;s
absolutely no sign of life from a powered off (or hibernating) machine until you press the power
button.</p>

<p>So I woke it up with the power button on the builtin keyboard, and watched it boot to the preboot
login screen associated with an encrypted boot drive<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>, and was further annoyed that at this
screen it was still ignoring the external keyboard plugged into the Thunderbolt display. Having
to use the builtin keyboard for a docked laptop is suboptimal. Anyway.</p>

<p>When it finished booting, I fired up pmset to ask it what&rsquo;s going on, first on AC power:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>magi@duality ~&gt; pmset -g
</span><span class='line'>Active Profiles:
</span><span class='line'>Battery Power     -1
</span><span class='line'>AC Power          -1*
</span><span class='line'>Currently in use:
</span><span class='line'> standbydelay         4200
</span><span class='line'> standby              0
</span><span class='line'> womp                 1
</span><span class='line'> halfdim              1
</span><span class='line'> hibernatefile        /var/vm/sleepimage
</span><span class='line'> darkwakes            0
</span><span class='line'> gpuswitch            2
</span><span class='line'> networkoversleep     0
</span><span class='line'> disksleep            10
</span><span class='line'> sleep                0
</span><span class='line'> autopoweroffdelay    14400
</span><span class='line'> hibernatemode        3
</span><span class='line'> autopoweroff         1
</span><span class='line'> ttyskeepawake        1
</span><span class='line'> displaysleep         10
</span><span class='line'> acwake               0
</span><span class='line'> lidwake              1</span></code></pre></td></tr></table></div></figure>


<p>And then again<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup> on battery:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>magi@duality ~&gt; pmset -g
</span><span class='line'>Active Profiles:
</span><span class='line'>Battery Power     -1*
</span><span class='line'>AC Power          -1
</span><span class='line'>Currently in use:
</span><span class='line'> standbydelay         4200
</span><span class='line'> standby              1
</span><span class='line'> halfdim              1
</span><span class='line'> hibernatefile        /var/vm/sleepimage
</span><span class='line'> darkwakes            0
</span><span class='line'> gpuswitch            2
</span><span class='line'> disksleep            10
</span><span class='line'> sleep                10
</span><span class='line'> autopoweroffdelay    14400
</span><span class='line'> hibernatemode        3
</span><span class='line'> autopoweroff         1
</span><span class='line'> ttyskeepawake        1
</span><span class='line'> displaysleep         2
</span><span class='line'> acwake               0
</span><span class='line'> lidwake              1</span></code></pre></td></tr></table></div></figure>


<p>As <a href="http://blog.metamatt.com/blog/2013/02/21/speedy-resume/">posted before</a>, I&rsquo;d previously changed <code>standbydelay</code>
to 43200 seconds on battery power, and disabled <code>standby</code> entirely on AC power. Apparently the 10.8.3
upgrade reverted the former change to Apple&rsquo;s new default of 4200 seconds, though it left the latter
change alone.</p>

<p>Note that&rsquo;s not quite consistent with my observation that my rMBP (bought in 2012 and shipped with
OS X 10.8) had <code>standby</code> enabled by default, while my previous MBP (bought in 2010 and shipped with
OS X 10.6 and subsequently upgraded to 10.7 and then 10.8) never had <code>standby</code> enabled at all.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>The FileVault preboot login screen also annoys me because it&rsquo;s got a pretty poor keyboard driver, and if I type my password at natural speed, it reproducibly detects one keystroke more than I intended to make. The same sequence of keystrokes is interpreted correctly by the real OS X keyboard stack. I reported this bug to Apple and they said they know and don&rsquo;t care.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>As an aside: anyone know how to get pmset to report the profile that&rsquo;s not active? <code>pmset -g</code> reports all settings for battery when on batter, and all settings for charger/AC when plugged into AC, and I have found no way to get all settings for both profiles short of running pmset twice, and physically plugging or unplugging the power connector between runs. Note that the set mode of pmset takes an optional <code>-a</code>/<code>-b</code>/<code>-c</code> argument to specify whether to change the values for battery, charger, or both profiles, but those aren&rsquo;t honored in conjunction with <code>-g</code>.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/17/from-tumblr-to-octopress-part-3-footnotes/">From Tumblr to Octopress, Part 3: Footnotes</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-17T01:42:00-07:00" pubdate data-updated="true">Mar 17<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/03/17/from-tumblr-to-octopress-part-3-footnotes/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Once I got Jekyll and Octopress to import my blog from Tumblr and generate it in its new format, almost everything was formatted correctly, with the marked exception of footnotes. Like a certain furious Canadian<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>, I&rsquo;ve become a fan of footnotes for adding detail without littering my posts with parenthetical expressions. In the migrated posts, the footnotes were there at the bottom, but the links to them were all wrong — full-sized unlinked numbers, instead of superscripted hyperlinks.</p>

<p>It took me a while to figure out what was wrong because there were actually 3 distinct problems. And as background, while it wasn&rsquo;t a direct problem here, you should understand that footnotes are not a feature of the <a href="http://daringfireball.net/projects/markdown/syntax">original Markdown syntax</a>, but were added later by other dialects, mostly converging around <a href="http://michelf.ca/projects/php-markdown/extra/#footnotes">PHP Markdown Extra</a>, which is what Tumblr uses.</p>

<p>First: The post content generated in Markdown format from tumblr.rb, in its trip through nokogiri and html2text and maybe elsewhere, didn&rsquo;t actually preserve the footnote declarations I&rsquo;d originally given Tumblr. Even though I had written these posts in Markdown format, and the Markdown form of my posts is presumably preserved somewhere at Tumblr<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>, tumblr.rb instead downloads HTML and then reverse-converts it back to Markdown format. This conversion doesn&rsquo;t preserve footnotes as Markdown footnotes; instead it leaves them as static HTML, and it renders the footnote bodies reasonably but the footnote links unreasonably.</p>

<p>So I had to go edit all the posts in which I used footnotes, and manually redo the footnote links using PHP Markdown Extra syntax.</p>

<p>Second: Having done that and told Jekyll to regenerate the blog, I found myself looking at a bunch of raw unconverted PHP Markdown Extra footnote tags. That&rsquo;s because Jekyll&rsquo;s markdown processing is done by RDiscount, and the version of RDiscount specified by Octopress&rsquo;s Gemfile (1.6.8) does not support footnotes at all; footnotes using PHP Markdown Extra syntax were added as a feature of RDiscount 2.0.7, as an optional extension named <code>footnotes</code>.</p>

<p>So I had to edit the Gemfile to specify RDiscount 2.0.7, and edit _config.yml to enable the footnotes extension. These changes look like:</p>

<p><code>Gemfile</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-  gem 'rdiscount', '~&gt; 1.6.8'
</span><span class='line'>+  gem 'rdiscount', '~&gt; 2.0.7'</span></code></pre></td></tr></table></div></figure>


<p><code>_config.yml</code>:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> markdown: rdiscount
</span><span class='line'>+rdiscount:
</span><span class='line'>+  extensions: [ footnotes ]</span></code></pre></td></tr></table></div></figure>


<p>Third: Having done that and told Jekyll to regenerate the blog, some posts looked fine, but others had chunks of footnote definition content floating near the end of the post body but before the footnotes, and completely out of order. Some trial and error led me to deduce that RDiscount 2.0.7 does not actually honor the documented PHP Markdown Extra syntax, which allows you to hard-wrap the footnotes or even place the definition offset from the footnote number<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>; RDiscount is happy only if the footnote number and entire body are on one logical line with no hard line breaks. Since I&rsquo;m doing all this posting from a colocated Linux VM on which I don&rsquo;t run X, and thus use text editors in old-school terminal windows, I tend to hard-break my posts (and in fact, the posts I imported from Tumblr tended to be hard-wrapped at 76 columns by something somewhere along the write/post/import pipeline). RDiscount doesn&rsquo;t play well with these hard breaks.</p>

<p>So I had to edit all the footnoted posts again to comply with RDiscount&rsquo;s actual behavior.</p>

<p>Summary: you can get nice footnotes from Octopress/Jekyll if you</p>

<ul>
<li>Update to RDiscount 2.0.7</li>
<li>Enable RDiscount&rsquo;s footnotes extension</li>
<li>Use the footnote syntax that RDiscount actually supports, which is like PHP Markdown Extra except each footnote definition must stay on one line without hard line breaks</li>
<li>If importing your blog from a previous home using a script like tumblr.rb, verify that the conversion actually generates footnote markup</li>
</ul>


<p>There&rsquo;s still one more bug with footnotes on the index page, which is that Jekyll generates each page independently through RDiscount, which generates in-page links between the footnotes and their bodies, using the footnote number: for the first footnote, the forward link is <code>#fn:1</code> and the backward link is <code>#fnref:1</code>. This works fine on individual pages, but on the index page the footnote numbers get reused and collide, so the in-page links don&rsquo;t work there. Syeong Gan has a post with <a href="http://syeong.jcsg.com/2012/07/07/octopress-footnote-problem/">a deeper description of this problem, and a possible workaround</a>.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p><a href="http://canadian-fury.com/2012/04/26/footnotify-and-octopress/">Footnotes, Footnotify and Octopress</a> has a pretty good argument in favor of footnotes, as well as a point-in-time description of how to get them to work in Octopress which I think is now outdated: he suggests switching from RDiscount to Kramdown; as mentioned above, RDiscount 2.0.7 added footnote support which mostly works. I tried Kramdown anyway and found RDiscount to do a slightly less bad job of honoring PHP Markdown Extra syntax than Kramdown does.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>MarsEdit can edit posts already posted at Tumblr, even if not originally authored with MarsEdit, in their original format: if the post was written in Markdown, MarsEdit&rsquo;s edit view sees Markdown. This might imply that there&rsquo;s a better way for Jekyll&rsquo;s tumblr.rb to use the Tumblr API to get the Markdown source, instead of the reverse-conversion it currently does.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>See the PHP Markdown Extra <a href="http://michelf.ca/projects/php-markdown/extra/#footnotes">documentation on footnotes</a>, notably the part starting with &ldquo;Footnotes can contain block-level elements&rdquo;.<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/17/from-tumblr-to-octopress-part-2-how/">From Tumblr to Octopress, Part 2: How</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-17T01:40:00-07:00" pubdate data-updated="true">Mar 17<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/03/17/from-tumblr-to-octopress-part-2-how/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Having decided to move this blog from Tumblr to Octopress, there remained the matter of migrating it<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>.</p>

<p>Octopress is basically a convenience framework around Jekyll, adding a nice-by-default theme and some convenience wrappers for starting new posts, invoking Jekyll to generate the site, and deploying the site. You could probably use Octopress quite happily without touching Jekyll directly, unless you want to import an existing blog; then you end up at <a href="https://github.com/mojombo/jekyll/wiki/blog-migrations">Jekyll&rsquo;s Blog Migrations tool</a>, which has options for a number of popular blog engines, including Tumblr.</p>

<p>The instructions for <a href="http://octopress.org/docs/setup/">setting up Octopress</a> are pretty simple and <a href="http://octopress.org/docs/setup/">well documented</a>:
* git and ruby (and probably rvm or rbenv) are prerequisites
* obtain octopress itself via &ldquo;git clone&rdquo;
* install dependencies via &ldquo;gem install bundler; bundle install&rdquo;
* install the default Octopress theme (which also generates the skeleton site layout) via &ldquo;rake install&rdquo;</p>

<p>At this point, you&rsquo;ve got a working Octopress installation and you could use its rake task-based interface to write and publish posts. However, if you want to migrate an existing blog, you have more setup steps which are also <a href="https://github.com/mojombo/jekyll/wiki/blog-migrations">well documented</a>:
* assuming you want to keep your raw posts in markdown format instead of raw HTML, Jekyll&rsquo;s Tumblr migrator needs nokogiri: <code>gem install nokogiri</code>
* invoke the Tumblr migrator (<code>ruby -rubygems -e 'require "jekyll/migrators/tumblr"; Jekyll::Tumblr.process("http://www.your_blog_url.com", "md")'</code>). Note that this doesn&rsquo;t require any account information or credentials, because the Tumblr API will provide enough information to do this anonymously. Heck, if you&rsquo;re evil, you could convert someone else&rsquo;s blog (don&rsquo;t do that). On the topic of Tumblr reliability, I ran this step a few dozen times while I was figuring out how it works and fixing some bugs in tumblr.rb, and ~90% of the time, it downloaded my ~165 posts almost instantly, but palpably often, it would get stuck halfway as the Tumblr API stopped sending it network traffic. Oh well. Ctrl-C and restart if this happens to you.</p>

<p>What neither the Jekyll nor Octopress documentation tells you is what happens next. Assuming you run all the above commands from the octopress directory: Octopress setup (the <code>rake install</code> step) created a directory called &ldquo;source&rdquo;, under which the (initially empty) &ldquo;_posts&rdquo; directory is where Jekyll will look for posts. Meanwhile, Jekyll&rsquo;s tumblr.rb will create and populate a &ldquo;<em>\posts/tumblr&rdquo; directory with your posts, and a &ldquo;posts&rdquo; directory with redirects from the old Tumblr-style post URLs to new Octopress-style URLs<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>,<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>. Neither the &ldquo;</em>\posts&rdquo; nor &ldquo;posts&rdquo; directory spit out by tumblr.rb are under &ldquo;source&rdquo; where Jekyll will look for them. What this means is that without additional effort on your part, Jekyll as invoked by Octopress won&rsquo;t see the files you just imported.</p>

<p>Again: your blog posts go in &ldquo;octopress/source/<em>posts&rdquo;. The Tumblr migrator will create &ldquo;octopress/posts&rdquo; and &ldquo;octopress/</em>posts&rdquo;. Just move these two directories under &ldquo;octopress/source&rdquo; once you&rsquo;ve verified they look OK. (NB: the migrator actually dumped all its files under &ldquo;octopress/<em>posts/tumblr&rdquo;; it&rsquo;s fine to leave them there, so they end up in &ldquo;octopress/source/</em>posts/tumblr&rdquo;; Octopress doesn&rsquo;t seem to care about the organization of your files inside the source/_posts directory.)</p>

<p>Now, you can tell Octopress to generate the site: &ldquo;rake generate&rdquo;.</p>

<p>If you&rsquo;re reading this at the right point of relative stability, lucky you; you win. I ran into several more issues, due to the fact that Jekyll and Octopress are prerelease open source software intended for an audience of hackers; some assembly definitely required:</p>

<ul>
<li>At the point I was performing this migration (January 2013), Jekyll was at version 0.12 and the tumblr.rb migrator script was broken in a <a href="https://github.com/mojombo/jekyll/commit/863643c7e8080c73a7968caabfc9c7e9b18c6b95">couple</a> <a href="https://github.com/mojombo/jekyll/commit/fbc9d0c66397234ab85e03a55955602e0ce40356">respects</a> which I submitted patches for.</li>
<li>After my patches were merged upstream, I tried running with Jekyll&rsquo;s head version in mid-February, to find that tumblr.rb had been deleted from the Jekyll repository entirely, and moved to a separate <a href="https://github.com/jekyll/jekyll-import">jekyll-import</a> project, which at the time had no documentation and appeared to have little chance of running.</li>
<li>Meanwhile, using any version of Jekyll newer than 0.12 broke Octopress in a trivial way; the :generate rule in Octopress&rsquo;s Rakefile finishes by invoking Jekyll as <code>system 'jekyll'</code>, with no arguments, and newer versions of Jekyll expect a <code>build</code> argument. Octopress will fix this when Jekyll actually releases a new version (which may have already happened between me finding this and posting this); it makes no sense to fix it sooner.</li>
</ul>


<p>This last list of foibles is probably all related to Jekyll being in the throes of the 1.0 release process and will probably be a historical footnote afterwards.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>Many others have done this before; one post I found helpful was <a href="http://blog.assimov.net/blog/2012/03/24/tumblr-to-octopress-powered-by-jekyll-and-markdown/">Goodbye Tumblr. Hello, Octopress Powered by Jekyll and Markdown!</a>.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>The redirects spit out by tumblr.rb are under &ldquo;posts&rdquo; because Tumblr URLs are of the form example.com/posts/12341234/post-title-slug; Octopress URLs are by default of the form example.com/blog/year/month/post-title-slug; tumblr.rb creates redirects from the former to the latter, without requiring any special interaction with the webserver, by just creating a file for each post, named for the Tumblr relative URL (in this case, posts/12341234/post-title-slug/index.html) containing a browser-side meta refresh redirect to the new URL.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>I found the redirects created by tumblr.rb to be not quite enough. Tumblr indexes posts by number, then creates a nice search-engine-friendly SLUG such as post-title-slug, yielding a post URL like example.com/posts/12341234/post-title-slug. But actually, when receiving a request, Tumblr ignores everything after the number, and you could also load that post as example.com/posts/12341234/foobar, or just example.com/posts/12341234, and in fact the latter is the canonical URL used by Disqus. If you are running a webserver with rewrite rules, you might do well to redirect the entire URL namespace under posts/12341234 to the new URL, as Tumblr would have; I settled for copying posts/12341234/post-title-slug/index.html to posts/12341234/index.html for each post, so both number alone and number+SLUG will redirect correctly.<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/03/17/from-tumblr-to-octopress-part-1-why/">From Tumblr to Octopress, Part 1: Why</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-03-17T01:37:00-07:00" pubdate data-updated="true">Mar 17<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/03/17/from-tumblr-to-octopress-part-1-why/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>When I first started this blog, I set it up at Tumblr so I wouldn&rsquo;t have to think about hosting it and could concentrate on writing.</p>

<p>I&rsquo;ve since realized that Tumblr is a bad match. Among things that I prioritize higher than Tumblr evidently does, reliability ranks high on the list<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>, as do control over site structure and appearance. Tumblr themes allow some control over appearance — and there are some very nice ones — but not the structure<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>.</p>

<p>Among things that they care about that I do not are their web posting interface, iOS native clients, a plethora of post types designed to be slightly quicker if you want to post audio/picture/video/quote content<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>, and a follower system<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup>.</p>

<p>So. On to Octopress. I get a lot more control over site structure, a more usable form of control over visual layout, and I can host it somewhere reliable (github for now, myself if I want to, and I can move hosting providers without having to do any deeper conversion).</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>Reliability problems with Tumblr have been intermittent; sometimes it works fine, sometimes I get &ldquo;the server returned no content&rdquo; errors 10 times in a row before I can load a single page.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>Tumblr&rsquo;s main navigational construct is a list of all posts sorted in descending order by posting date. Individual posts get permalinks, and there&rsquo;s a very slow-loading calendar view which gives some semblance of an overall table of contents, but there&rsquo;s no really usable way to do monthly archives or next/previous links to stitch time back together.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>All Tumblr posts have a URL, a title, and a body; what goes into the body can include really anything you can embed in a webpage, including audio and video. Presumably in an attempt to move beyond text-heavy blogging, in addition to letting you embed pictures/audio/video in a normal &ldquo;text&rdquo; post, Tumblr added these separate post types that special-case the body (the &ldquo;link&rdquo; post type makes the title into a navigable link; the &ldquo;quote&rdquo; type puts quotes around the body, etc). All of these are less general than the &ldquo;text&rdquo; type; they are also poorly represented in the API and, as I&rsquo;ve found out, commensurately poorly handled by export tools. I dabbled in the special post types a few times, and am mostly sorry I did.<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
<li id="fn:4">
<p>Readers are unlikely to be Tumblr users; that&rsquo;s what RSS is for.<a href="#fnref:4" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/25/os-x-has-a-builtin-wi-fi-network-scanner/">OS X Has a Builtin Wi-Fi Network Scanner</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-25T00:00:00-08:00" pubdate data-updated="true">Feb 25<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/25/os-x-has-a-builtin-wi-fi-network-scanner/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here&rsquo;s a bonus on top of a bonus: OS X 10.8 (Mountain Lion) adds a really
useful &ldquo;Wi-Fi&rdquo; scan feature, buried inside a utility I didn&rsquo;t know existed.</p>

<p>I wanted a Wi-Fi scan tool to show me a list of nearby wireless networks and
strengths, so I could avoid interference from existing networks when placing
and choosing a channel for a new access point, and verify the new access point
is operating properly. A few years ago I did this with KisMAC, MacStumbler or
iStumbler, but these utilities seem to have stopped working over time, either
as a result of newer hardware or newer OSes.</p>

<p>Googling for new alternatives to these utilities, I found that <a href="http://osxdaily.com/2012/07/31/wi-%0Afi-scanner-mac-os-x-mountain-lion/">Mountain Lion
actually has this functionality built in</a>. There&rsquo;s a &ldquo;Wi-Fi Diagnostics&rdquo; app buried
in /System/Library/CoreServices (where, annoyingly, Spotlight can&rsquo;t find it
and the Finder by default won&rsquo;t show it); at launch it presents a very
limited-looking wizard interface, but in the menubar the File:New command and
command-N keyboard shortcut have been replaced by an unassuming &ldquo;Network
Utilities&rdquo; command.</p>

<p>This brings up a &ldquo;Network Utilities&rdquo; window, not to be confused with
/Applications/Utilities/Network Utility.app, with a bunch of really useful
utilities (which look like a strict superset of the old Network Utility, have
a more modern UI and additional functionality, and except for the &ldquo;Wi-Fi Scan&rdquo;
tab, have no reason to be restricted to Wi-Fi networks).</p>

<p>I only wish this thing were easier to find; it should probably replace the old
Network Utility app. I don&rsquo;t remember seeing it mentioned in most what&rsquo;s-new-
and-why-to-upgrade articles about Mountain Lion. For me, it&rsquo;s a pretty nice
bonus to having upgraded and deserves wider mention.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/25/a-waterproof-tablet-a-step-in-in-the-right-direction/">A Waterproof Tablet! A Step in in the Right Direction</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-25T00:00:00-08:00" pubdate data-updated="true">Feb 25<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/25/a-waterproof-tablet-a-step-in-in-the-right-direction/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In <a href="http://arstechnica.com/gadgets/2013/02/sony-unveils-thinnest-10-1-tablet-ever-the-xperia-tablet-z/">this announcement of a new Sony tablet for Android</a>, the following bit stood out to me:</p>

<blockquote><p>The company claims the tablet is not only the “world’s thinnest 10.1-inch
tablet” at 6.9 millimeters, but it&rsquo;s apparently waterproof in up to three feet
of water for 30 minutes.</p></blockquote>

<p>The water resistance is a lot more notable to me than the thinness, in an
industry obsessed with thin fragile things, given how many phones I&rsquo;ve seen
destroyed by water, and given how <a href="http://blog.metamatt.com/blog/2012/08/20/iphone-hardware-wishlist/">I put this on my wishlist for the iPhone 5</a>
last fall. But phones see a lot more exposure to dangerous circumstances than
tablets do, I wager, so I&rsquo;d still like to see this feature make its way over
to phones.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/21/speedy-resume/">Speedy Resume</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-21T00:00:00-08:00" pubdate data-updated="true">Feb 21<span>st</span>, 2013</time>
        
         | <a href="/blog/2013/02/21/speedy-resume/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My initial reason for switching from Windows laptops to Mac laptops 7 years
ago — which has remained a primary benefit across those 7 years — was better
power management. The details are many but the result is simple: a laptop that
sleeps and wakes consistently and quickly, which never crashes on wakeup,
never drops the Wi-Fi connection on wakeup, and is on the network and ready
for me to type almost as soon as I open the lid. Almost like what we expect
from a tablet or smartphone.</p>

<p>That&rsquo;s the dream, anyway. I&rsquo;ve never owned or used a Windows laptop (or Linux
laptop, for that matter) that pulled that off, and not for lack of trying. It
was much truer of Apple laptops running Mac OS X, ever since their
introduction in 2001. It remained one of my favorite things about more recent
Macbooks, but I&rsquo;ve found it getting less true over time, culminating in my
2012 &ldquo;Macbook Pro with Retina Display&rdquo; (henceforth rMBP), which seems to take
like 30 seconds to wake from sleep, then sometimes crashes immediately as the
crowning touch.</p>

<p>After getting frustrated enough by the slow wakeup time to get to the bottom
of it, I think there are 3 pieces to the puzzle.</p>

<ol>
<li><p> The rMBP (like Macbook Air models) has no external status lights. No charge level indicator on the battery like older models with removable batteries, no charge level indicator on the side of the unit like previous unibody Macbook Pro models, no power light that winks while asleep and glows while awake like all previous Macbook models. So when you open the lid, if it wakes up and is ready for use, great, but if not, you don&rsquo;t know whether it&rsquo;s powered off, has a dead battery, or is already trying to wake up and just taking its sweet time.</p></li>
<li><p> The default power-management plan is &ldquo;Safe Sleep&rdquo;, which means that when you close the lid the computer writes a suspend image to disk, then suspends to RAM<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>. Then wakeup is normally fast because RAM contents are still present, but if power is lost for any reason (battery dies, battery is removed on models where that&rsquo;s possible, or the computer decides to power itself off to stop expending battery power to support the RAM), it can still resume from where you left it, just more slowly, by reading from disk. This last bit about deciding to power itself off is crucial; it&rsquo;s controlled by a parameter known as <code>standbydelay</code>, and on this computer at least (rMBP running OS X 10.8) the default value of <code>standbydelay</code> was 4200 seconds, or 70 minutes, just over an hour. This means if you suspend the computer and wake it up again within 70 minutes, it will resume from RAM, but if you leave it asleep for more than 70 minutes, it will have powered off entirely, and will resume from disk. On my previous laptop (a 13&#8221; Macbook Pro from 2010, also now running OS X 10.8), <code>standbydelay</code> was not set at all, which I assume means it will try to keep RAM supplied with power until the battery dies. I don&rsquo;t know the reason for the different defaults.</p></li>
<li><p> This rMBP has 16 gigabytes of RAM, more than any laptop I&rsquo;ve owned in the past. Now, it also has a fast SSD, so I wouldn&rsquo;t have thought it would take that much longer to resume from disk vs RAM (and in actual usage it shouldn&rsquo;t have to save and restore all of it anyway) but it&rsquo;s likely a factor: if it had to transfer the entire 16GB, even at 500 MB/sec that would be 32 seconds. It actually only needs to save/restore the active pages; say on average that&rsquo;s 60% of memory and add a few seconds to get the hardware devices from cold boot to powered on, and you&rsquo;re in the 20 second ballpark that is long enough to annoy me.</p></li>
</ol>


<p>So boiled down: this machine feels slower to resume than previous ones because
it&rsquo;s suspending to disk, has a lot of memory to restore from disk, and doesn&rsquo;t
show any visible signs of progress while restoring from disk.</p>

<p>I changed the <code>standbydelay</code> value to 12 hours on battery (<code>sudo pmset -b
standbydelay 43200</code>) and disabled it entirely on AC power (<code>sudo pmset -c
standby 0</code>) and things seem much better now<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>.</p>

<p>Oh. And sleep reliability<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup>? That&rsquo;s even more important. When I first got the
rMBP, it would kernel panic and show &ldquo;Your computer must be restarted&rdquo; when
resuming from sleep once in a while, roughly once a month. That was
intolerable; at a guess I disabled PowerNap; I don&rsquo;t know whether it was the
actual problem but I haven&rsquo;t had reliability problems since.</p>

<p>So these are my current recommendations for power management on a rMBP or
Macbook Air:</p>

<ul>
<li>Increase <code>standbydelay</code> value enough that you don&rsquo;t notice the computer resuming from disk in normal use</li>
<li>Disable PowerNap</li>
</ul>

<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>The difference between suspend-to-disk and suspend-to-RAM is that suspend-to-RAM expends battery power to keep the contents of RAM alive, so wakeup is faster, while suspend-to-disk extends battery life at the expense of slower wakeup.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>I didn&rsquo;t realize the import of this at first, but Mac OS maintains separate sleep policies for battery and AC power, and pmset can set either one (-b for battery, -c for charger) or both (-a for both, which is also the default); so there are two <code>standbydelay</code> values. I have my computer set to never sleep on AC power, but I sleep it manually by closing the lid when I&rsquo;m not using it. After having applied the longer standbydelay to battery, I was annoyed to find the computer slow to wake after leaving it asleep and charging for a while. Hence the second command to entirely disable the <code>standby</code> behavior on AC power.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>When talking about sleep reliability, what&rsquo;s actually important is the ability to <em>wake back up</em> reliably, just like when talking about backup reliability, what&rsquo;s important is the ability to restore from backups. It&rsquo;s the round trip that matters.<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/13/two-things-i-didnt-know-about-mac-os-internet-sharing/">Two Things I Didn&#8217;t Know About Mac OS Internet Sharing</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-13T00:00:00-08:00" pubdate data-updated="true">Feb 13<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/13/two-things-i-didnt-know-about-mac-os-internet-sharing/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>On a recent trip to Mexico, we stayed in a hotel that charged a significant
extra fee for fairly slow Internet access. After paying for an access code, we
could associate one device at a time to the Wi-Fi network; we could use
multiple devices only by paying for multiple codes (which we didn&rsquo;t want to do
because for the speed, even paying once was a poor value) or by disconnecting
the previous device.</p>

<p>Of course, I went looking for ways around this. We had at our disposal a Mac
laptop, two iPads and two iPhones. Mac OS X has <a href="http://support.apple.com/kb/PH6589">built-in Internet connection
sharing</a>, but it operates only between
separate network adapters: you can share an Ethernet-connected Internet
connection over Wi-Fi, or vice versa, but you can&rsquo;t share Wi-Fi over Wi-Fi<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>.
There&rsquo;s some reason to hope that this would be possible &mdash; it&rsquo;s &ldquo;just&rdquo; a
software problem<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>; Windows and Linux generally support multiple virtual Wi-Fi
interfaces from the same physical device, as used by <a href="http://www.connectify.me/hotspot/">Connectify
Hotspot</a> for Windows or the multi-SSID
feature in many Linux-based Wi-Fi access points &mdash; but this software feature
doesn&rsquo;t exist for Mac OS X.</p>

<p>So, no sharing Wi-Fi over Wi-Fi with my Mac laptop, unfortunately. But there&rsquo;s
another option that works without additional hardware; this is where the
learning comes in. <strong>First new fact</strong>: you can share an Internet connection
over Bluetooth. I&rsquo;d thought this was only for sharing a cellular data
connection from a phone to a computer (under the oxymoronic misnomer of
&ldquo;wireless tethering&rdquo;), but it turns out to work in the other direction (known
as &ldquo;reverse tethering&rdquo;). If you pair an iPhone or iPad with a Mac over
Bluetooth, your Mac will grow a new network adapter called &ldquo;Bluetooth PAN&rdquo;
(for Personal Area Network); you can then use the normal Sharing preference
panel to enable Internet Sharing from Wi-Fi to Bluetooth PAN. Bingo.</p>

<p>(I can claim only partial success here, but it was good enough for me at the
time. This technique works fine for iPads, but not iPhones. I don&rsquo;t know why;
<a href="https://discussions.apple.com/message/20996155#20996155">nobody else seems to know why
either</a>.)</p>

<p>That got us past our trip, and I was happy to have a new tool for my cheap-
connectivity-while-traveling toolbox. However, when we returned home, I had an
unpleasant surprise, though it took me a while to connect the dots. My Mac
laptop was getting really hot when I left it plugged in overnight to charge. I
eventually realized this was because it wasn&rsquo;t asleep, even with the lid
closed (and with the lid closed, it generates more heat than it can
comfortably dissipate, even at idle). This was frustrating because there are
so many things that can keep a Mac from sleeping; this is where more learning
comes in. Googling for ways to identify causes of Mac insomnia, I learned of
the <code>pmset -g log</code> command, which I now highly recommend. It pointed me right
at the culprit. <strong>Second new fact</strong>: Internet connection sharing prevents the
Mac from sleeping while plugged in. (This is actually incredibly obvious in
retrospect; it says so right in the Sharing panel: &ldquo;Computers connected to AC
power won&rsquo;t sleep while Internet Sharing is turned on.&rdquo; I hadn&rsquo;t read that
while enabling Internet Sharing because I thought I already knew how to use
it; by the time it was causing problems, the problems were too disconnected
from the cause.)</p>

<p>In summary: Internet connection sharing is useful, and the Bluetooth PAN
variant is further useful, but don&rsquo;t leave it on when you&rsquo;re not using it.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>Well, you can share Wi-Fi over Wi-Fi if you have multiple physical Wi-Fi interfaces. My laptop only has the one built-in Wi-Fi interface. It might be worth carrying a cheap additional USB Wi-Fi device for this reason. That would probably be the cheapest reliable solution to this problem.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>At the physical layer, a single Wi-Fi radio can only be tuned to a single channel, but nothing stops it from participating in multiple SSIDs as long as they&rsquo;re all on that channel.<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/13/troubleshooting-mac-sleep-problems/">Troubleshooting Mac Sleep Problems</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-13T00:00:00-08:00" pubdate data-updated="true">Feb 13<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/13/troubleshooting-mac-sleep-problems/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here&rsquo;s a useful nugget if you&rsquo;re inclined to poke at computers to see how they
work: <code>pmset -g log</code>.</p>

<p>I had a problem where my rMBP would sleep just fine on battery power but <a href="http://blog.metamatt.com/blog/2013/02/13/two-%0Athings-i-didnt-know-about-mac-os-internet-sharing/">not
when plugged into its charger</a>. Even with the lid closed,
and even if I explicitly poked the Sleep button first. This meant my chair got
really warm if I left the computer sitting there plugged in to charge
overnight. (NB: I did have the slider in energy saver preferences set to
sleep:never for AC, but that should only affect sleep-after-idle, not lid-
close or explicit sleep request.)</p>

<p>The command <code>pmset -g log</code> helped me learn that this state, where the computer
is awake with the lid closed and no external display or keyboard is attached,
is called DarkWake and that InternetSharing was the entity requesting that
over sleep.</p>

<p>Now that I know about DarkWake, I&rsquo;m curious what the relationship is between
it and <a href="http://support.apple.com/kb/ht5394">PowerNap</a>. On this same rMBP, I
disabled PowerNap because it would occasionally kernel panic when waking from
sleep; I forget how I decided that was PowerNap but it hasn&rsquo;t happened since
disabling.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/31/google-default-account-for-multiple-sign-in/">Google Default Account for Multiple Sign In</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-31T00:00:00-08:00" pubdate data-updated="true">Jan 31<span>st</span>, 2013</time>
        
         | <a href="/blog/2013/01/31/google-default-account-for-multiple-sign-in/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Google Accounts allow you to <a href="http://support.google.com/accounts/bin/answer.py?hl=en&amp;answer=1721977">stay signed into multiple accounts at
once</a>,
which is hugely helpful for those of us who have multiple account, but there&rsquo;s
one thing that&rsquo;s been frustrating me here.</p>

<p>I use the browser address bar (relying heavily on its autocomplete feature) to
do most of my navigation directly from the keyboard. If I want my document
files in Google Docs, I open a new browser tab from the keyboard shortcut,
then type &ldquo;docs&rdquo; and by that time, autocomplete has already filled in
docs.google.com<sup id="fnref:1"><a href="#fn:1" rel="footnote">1</a></sup>,<sup id="fnref:2"><a href="#fn:2" rel="footnote">2</a></sup>.</p>

<p>However, I have 3 different Google Accounts that I&rsquo;m usually signed into: one
standard personal account (ending in @gmail.com), one GAFYD<sup id="fnref:3"><a href="#fn:3" rel="footnote">3</a></sup> account for my
personal email<sup id="fnref:4"><a href="#fn:4" rel="footnote">4</a></sup>, and one GAFYD account for work. If I navigate to
docs.google.com, Google automatically chooses one of the accounts to redirect
to, and at different times on different computers I end up with a different
(seemingly arbitrary) account selected, and if it wasn&rsquo;t the right one, it&rsquo;s 3
extra clicks in the account switcher to get to the right account.</p>

<p>What&rsquo;s controlling its choice? It turns out it&rsquo;s the order you sign into the
accounts. If you look closely at the URLs, either by mousing over the links in
the account switcher or by looking at the URL you end up at for gmail but not
for docs<sup id="fnref:5"><a href="#fn:5" rel="footnote">5</a></sup>, you&rsquo;ll see an &ldquo;authuser&rdquo; or &ldquo;u&rdquo; parameter which is a low-valued
integer. It starts at 0 for the first account you sign into, and counts up
from there as you sign into additional accounts.</p>

<p>If you navigate directly to docs.google.com (or mail.google.com, etc), you&rsquo;ll
get the account currently associated as authuser 0, which is the first account
you signed into.</p>

<p>For the GAFYD case, Google lets you <a href="http://support.google.com/a/bin/answer.py?hl=en&amp;answer=53340">set up convenient forwarding
addresses</a> for
domains you control, and I&rsquo;ve used this to map mail.mydomain.foo and
docs.mydomain.foo to redirect automatically to mail.google.com/a/mydomain.foo
and docs.google.com/a/mydomain.foo. This means that for the two GAFYD domains,
if I want the mail or docs view associated with that account, I go to
docs.mydomain.foo, which in turn means that if I navigate to docs.google.com,
I always want my personal account selected by default.</p>

<p>For me, the solution to get the behavior I wanted boils down to:</p>

<ul>
<li>Sign out (which signs you out of all acocunts)</li>
<li>Sign into the primary account which I want as default (the one ending in gmail.com) first, then sign into the others.</li>
<li>Always use this same signin order in the future.</li>
</ul>


<p>Thanks go to <a href="http://www.linkedin.com/pub/ramesh-dharan/1/13b/8a2">Ramesh</a> for
helping me figure this out.</p>
<div class="footnotes">
<hr/>
<ol>
<li id="fn:1">
<p>Google has rebranded Google Docs as Google Drive, and docs.google.com redirects to drive.google.com. I haven&rsquo;t retrained my fingers, so I always type &ldquo;docs&rdquo;, so I&rsquo;ll keep using the old name. Both names work fine as described in this post.<a href="#fnref:1" rev="footnote">&#8617;</a></p></li>
<li id="fn:2">
<p>(Everything in this post is true for other Google Accounts services like gmail, as well, but docs is the one I navigate directly to the most frequently, so I&rsquo;ll stick with it for the example.)<a href="#fnref:2" rev="footnote">&#8617;</a></p></li>
<li id="fn:3">
<p>Google Apps for Your Domain, back when that was a thing; since rebranded as <a href="http://www.google.com/intl/en/enterprise/apps/business/">Google Apps for Business</a> once they removed the free option.<a href="#fnref:3" rev="footnote">&#8617;</a></p></li>
<li id="fn:4">
<p>Why a separate gmail.com and personal GAFYD account? I&rsquo;ve long used the same personal email address at a domain I control, predating Gmail. When Google created Gmail and started tacking many other services onto your Gmail account, becoming Google Accounts, I signed up with a gmail address but didn&rsquo;t use it for email, just for Google Accounts. At some point I got tired of running my own email server and dealing with reliability and spam, so I decided to let Google host it via the then-free GAFYD. I could have just forwarded mail from the vanity address to the gmail address without setting up another mailbox, but it seemed simpler to keep them separate. That may have been a mistake.<a href="#fnref:4" rev="footnote">&#8617;</a></p></li>
<li id="fn:5">
<p>The URLs vary by service, so this isn&rsquo;t as obvious as it could be. Docs/Drive uses URLs like drive.google.com/?authuser=N in the account switcher, but for a GAFYD account, you actually end up at drive.google.com/a/mydomain.foo. Gmail uses URLs like mail.google.com/u/N, both in the account switcher and where you actually end up, though for a GAFYD account you can also navigate to mail.google.com/a/mydomain.foo (and you&rsquo;ll be redirected to mail.google.com/u/N for the correct value of N if you&rsquo;re already signed into that account, and to the login page if you&rsquo;re not).<a href="#fnref:5" rev="footnote">&#8617;</a></p></li>
</ol>
</div>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/03/20/apple-is-getting-really-aggressive-about-this-sleepdelay-thing/">Apple is getting really aggressive about this sleepdelay thing</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/17/from-tumblr-to-octopress-part-3-footnotes/">From Tumblr to Octopress, part 3: footnotes</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/17/from-tumblr-to-octopress-part-2-how/">From Tumblr to Octopress, part 2: how</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/03/17/from-tumblr-to-octopress-part-1-why/">From Tumblr to Octopress, part 1: why</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/25/os-x-has-a-builtin-wi-fi-network-scanner/">OS X has a builtin Wi-Fi network scanner</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/metamatt">@metamatt</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'metamatt',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("metamatt", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/metamatt" class="twitter-follow-button" data-show-count="false">Follow @metamatt</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/117348958487049022391?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Matt Ginzton -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'metamatt';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
