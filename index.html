
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Step 2 is the hard part.</title>
  <meta name="author" content="Matt Ginzton">

  
  <meta name="description" content="Here&#8217;s a bonus on top of a bonus: OS X 10.8 (Mountain Lion) adds a really
useful &#8220;Wi-Fi&#8221; scan feature, buried inside a utility I &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://metamatt.github.com/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Step 2 is the hard part." type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-19563060-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">Step 2 is the hard part.</a></h1>
  
    <h2>Matt Ginzton writes here.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:metamatt.github.com" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/25/os-x-has-a-builtin-wi-fi-network-scanner/">OS X Has a Builtin Wi-Fi Network Scanner</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-25T00:00:00-08:00" pubdate data-updated="true">Feb 25<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/25/os-x-has-a-builtin-wi-fi-network-scanner/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here&#8217;s a bonus on top of a bonus: OS X 10.8 (Mountain Lion) adds a really
useful &#8220;Wi-Fi&#8221; scan feature, buried inside a utility I didn&#8217;t know existed.</p>

<p>I wanted a Wi-Fi scan tool to show me a list of nearby wireless networks and
strengths, so I could avoid interference from existing networks when placing
and choosing a channel for a new access point, and verify the new access point
is operating properly. A few years ago I did this with KisMAC, MacStumbler or
iStumbler, but these utilities seem to have stopped working over time, either
as a result of newer hardware or newer OSes.</p>

<p>Googling for new alternatives to these utilities, I found that <a href="http://osxdaily.com/2012/07/31/wi-%0Afi-scanner-mac-os-x-mountain-lion/">Mountain Lion
actually has this functionality built in</a>. There&#8217;s a &#8220;Wi-Fi Diagnostics&#8221; app buried
in /System/Library/CoreServices (where, annoyingly, Spotlight can&#8217;t find it
and the Finder by default won&#8217;t show it); at launch it presents a very
limited-looking wizard interface, but in the menubar the File:New command and
command-N keyboard shortcut have been replaced by an unassuming &#8220;Network
Utilities&#8221; command.</p>

<p>This brings up a &#8220;Network Utilities&#8221; window, not to be confused with
/Applications/Utilities/Network Utility.app, with a bunch of really useful
utilities (which look like a strict superset of the old Network Utility, have
a more modern UI and additional functionality, and except for the &#8220;Wi-Fi Scan&#8221;
tab, have no reason to be restricted to Wi-Fi networks).</p>

<p>I only wish this thing were easier to find; it should probably replace the old
Network Utility app. I don&#8217;t remember seeing it mentioned in most what&#8217;s-new-
and-why-to-upgrade articles about Mountain Lion. For me, it&#8217;s a pretty nice
bonus to having upgraded and deserves wider mention.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/25/a-waterproof-tablet-a-step-in-in-the-right-direction/">A Waterproof Tablet! A Step in in the Right Direction</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-25T00:00:00-08:00" pubdate data-updated="true">Feb 25<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/25/a-waterproof-tablet-a-step-in-in-the-right-direction/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In <a href="http://arstechnica.com/gadgets/2013/02/sony-unveils-thinnest-10-1%0A-tablet-ever-the-xperia-tablet-z/">this announcement of a new Sony tablet for
Android</a>, the following bit stood out to me:</p>

<blockquote><p>The company claims the tablet is not only the “world’s thinnest 10.1-inch
tablet” at 6.9 millimeters, but it&#8217;s apparently waterproof in up to three feet
of water for 30 minutes.</p></blockquote>

<p>The water resistance is a lot more notable to me than the thinness, in an
industry obsessed with thin fragile things, given how many phones I&#8217;ve seen
destroyed by water, and given how <a href="http://blog.metamatt.com/blog/2012/08/20/iphone-hardware-wishlist/">I put this on my wishlist for the iPhone
5</a> last
fall. But phones see a lot more exposure to dangerous circumstances than
tablets do, I wager, so I&#8217;d still like to see this feature make its way over
to phones.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/21/speedy-resume/">Speedy Resume</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-21T00:00:00-08:00" pubdate data-updated="true">Feb 21<span>st</span>, 2013</time>
        
         | <a href="/blog/2013/02/21/speedy-resume/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>My initial reason for switching from Windows laptops to Mac laptops 7 years
ago — which has remained a primary benefit across those 7 years — was better
power management. The details are many but the result is simple: a laptop that
sleeps and wakes consistently and quickly, which never crashes on wakeup,
never drops the Wi-Fi connection on wakeup, and is on the network and ready
for me to type almost as soon as I open the lid. Almost like what we expect
from a tablet or smartphone.</p>

<p>That&#8217;s the dream, anyway. I&#8217;ve never owned or used a Windows laptop (or Linux
laptop, for that matter) that pulled that off, and not for lack of trying. It
was much truer of Apple laptops running Mac OS X, ever since their
introduction in 2001. It remained one of my favorite things about more recent
Macbooks, but I&#8217;ve found it getting less true over time, culminating in my
2012 &#8220;Macbook Pro with Retina Display&#8221; (henceforth rMBP), which seems to take
like 30 seconds to wake from sleep, then sometimes crashes immediately as the
crowning touch.</p>

<p>After getting frustrated enough by the slow wakeup time to get to the bottom
of it, I think there are 3 pieces to the puzzle.</p>

<ol>
<li><p>The rMBP (like Macbook Air models) has no external status lights. No charge level indicator on the battery like older models with removable batteries, no charge level indicator on the side of the unit like previous unibody Macbook Pro models, no power light that winks while asleep and glows while awake like all previous Macbook models. So when you open the lid, if it wakes up and is ready for use, great, but if not, you don&#8217;t know whether it&#8217;s powered off, has a dead battery, or is already trying to wake up and just taking its sweet time.</p></li>
<li><p>The default power-management plan is &#8220;Safe Sleep&#8221;, which means that when you close the lid the computer writes a suspend image to disk, then suspends to RAM1. Then wakeup is normally fast because RAM contents are still present, but if power is lost for any reason (battery dies, battery is removed on models where that&#8217;s possible, or the computer decides to power itself off to stop expending battery power to support the RAM), it can still resume from where you left it, just more slowly, by reading from disk. This last bit about deciding to power itself off is crucial; it&#8217;s controlled by a parameter known as <code>standbydelay</code>, and on this computer at least (rMBP running OS X 10.8) the default value of <code>standbydelay</code> was 4200 seconds, or 70 minutes, just over an hour. This means if you suspend the computer and wake it up again within 70 minutes, it will resume from RAM, but if you leave it asleep for more than 70 minutes, it will have powered off entirely, and will resume from disk. On my previous laptop (a 13&#8221; Macbook Pro from 2010, also now running OS X 10.8), <code>standbydelay</code> was not set at all, which I assume means it will try to keep RAM supplied with power until the battery dies. I don&#8217;t know the reason for the different defaults.</p></li>
<li><p>This rMBP has 16 gigabytes of RAM, more than any laptop I&#8217;ve owned in the past. Now, it also has a fast SSD, so I wouldn&#8217;t have thought it would take that much longer to resume from disk vs RAM (and in actual usage it shouldn&#8217;t have to save and restore all of it anyway) but it&#8217;s likely a factor: if it had to transfer the entire 16GB, even at 500 MB/sec that would be 32 seconds. It actually only needs to save/restore the active pages; say on average that&#8217;s 60% of memory and add a few seconds to get the hardware devices from cold boot to powered on, and you&#8217;re in the 20 second ballpark that is long enough to annoy me.</p></li>
</ol>


<p>So boiled down: this machine feels slower to resume than previous ones because
it&#8217;s suspending to disk, has a lot of memory to restore from disk, and doesn&#8217;t
show any visible signs of progress while restoring from disk.</p>

<p>I changed the <code>standbydelay</code> value to 12 hours on battery (<code>sudo pmset -b
standbydelay 43200</code>) and disabled it entirely on AC power (<code>sudo pmset -a
standby 0</code>) and things seem much better now2.</p>

<p>Oh. And sleep reliability3? That&#8217;s even more important. When I first got the
rMBP, it would kernel panic and show &#8220;Your computer must be restarted&#8221; when
resuming from sleep once in a while, roughly once a month. That was
intolerable; at a guess I disabled PowerNap; I don&#8217;t know whether it was the
actual problem but I haven&#8217;t had reliability problems since.</p>

<p>So these are my current recommendations for power management on a rMBP or
Macbook Air:</p>

<ul>
<li>Increase <code>standbydelay</code> value enough that you don&#8217;t notice the computer resuming from disk in normal use</li>
<li>Disable PowerNap</li>
</ul>


<hr />

<ol>
<li><p>The difference between suspend-to-disk and suspend-to-RAM is that suspend-to-RAM expends battery power to keep the contents of RAM alive, so wakeup is faster, while suspend-to-disk extends battery life at the expense of slower wakeup. ↩</p></li>
<li><p>I didn&#8217;t realize the import of this at first, but Mac OS maintains separate sleep policies for battery and AC power, and pmset can set either one (-b for battery, -c for charger) or both (-a for both, which is also the default); so there are two <code>standbydelay</code> values. I have my computer set to never sleep on AC power, but I sleep it manually by closing the lid when I&#8217;m not using it. After having applied the longer standbydelay to battery, I was annoyed to find the computer slow to wake after leaving it asleep and charging for a while. Hence the second command to entirely disable the <code>standby</code> behavior on AC power. ↩</p></li>
<li><p>When talking about sleep reliability, what&#8217;s actually important is the ability to <em>wake back up</em> reliably, just like when talking about backup reliability, what&#8217;s important is the ability to restore from backups. It&#8217;s the round trip that matters. ↩</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/13/two-things-i-didnt-know-about-mac-os-internet-sharing/">Two Things I Didn&#8217;t Know About Mac OS Internet Sharing</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-13T00:00:00-08:00" pubdate data-updated="true">Feb 13<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/13/two-things-i-didnt-know-about-mac-os-internet-sharing/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>On a recent trip to Mexico, we stayed in a hotel that charged a significant
extra fee for fairly slow Internet access. After paying for an access code, we
could associate one device at a time to the Wi-Fi network; we could use
multiple devices only by paying for multiple codes (which we didn&#8217;t want to do
because for the speed, even paying once was a poor value) or by disconnecting
the previous device.</p>

<p>Of course, I went looking for ways around this. We had at our disposal a Mac
laptop, two iPads and two iPhones. Mac OS X has <a href="http://support.apple.com/kb/PH6589">built-in Internet connection
sharing</a>, but it operates only between
separate network adapters: you can share an Ethernet-connected Internet
connection over Wi-Fi, or vice versa, but you can&#8217;t share Wi-Fi over Wi-Fi1.
There&#8217;s some reason to hope that this would be possible &#8211; it&#8217;s &#8220;just&#8221; a
software problem2; Windows and Linux generally support multiple virtual Wi-Fi
interfaces from the same physical device, as used by <a href="http://www.connectify.me/hotspot/">Connectify
Hotspot</a> for Windows or the multi-SSID
feature in many Linux-based Wi-Fi access points &#8211; but this software feature
doesn&#8217;t exist for Mac OS X.</p>

<p>So, no sharing Wi-Fi over Wi-Fi with my Mac laptop, unfortunately. But there&#8217;s
another option that works without additional hardware; this is where the
learning comes in. <strong>First new fact</strong>: you can share an Internet connection
over Bluetooth. I&#8217;d thought this was only for sharing a cellular data
connection from a phone to a computer (under the oxymoronic misnomer of
&#8220;wireless tethering&#8221;), but it turns out to work in the other direction (known
as &#8220;reverse tethering&#8221;). If you pair an iPhone or iPad with a Mac over
Bluetooth, your Mac will grow a new network adapter called &#8220;Bluetooth PAN&#8221;
(for Personal Area Network); you can then use the normal Sharing preference
panel to enable Internet Sharing from Wi-Fi to Bluetooth PAN. Bingo.</p>

<p>(I can claim only partial success here, but it was good enough for me at the
time. This technique works fine for iPads, but not iPhones. I don&#8217;t know why;
<a href="https://discussions.apple.com/message/20996155#20996155">nobody else seems to know why
either</a>.)</p>

<p>That got us past our trip, and I was happy to have a new tool for my cheap-
connectivity-while-traveling toolbox. However, when we returned home, I had an
unpleasant surprise, though it took me a while to connect the dots. My Mac
laptop was getting really hot when I left it plugged in overnight to charge. I
eventually realized this was because it wasn&#8217;t asleep, even with the lid
closed (and with the lid closed, it generates more heat than it can
comfortably dissipate, even at idle). This was frustrating because there are
so many things that can keep a Mac from sleeping; this is where more learning
comes in. Googling for ways to identify causes of Mac insomnia, I learned of
the <code>pmset -g log</code> command, which I now highly recommend. It pointed me right
at the culprit. <strong>Second new fact</strong>: Internet connection sharing prevents the
Mac from sleeping while plugged in. (This is actually incredibly obvious in
retrospect; it says so right in the Sharing panel: &#8220;Computers connected to AC
power won&#8217;t sleep while Internet Sharing is turned on.&#8221; I hadn&#8217;t read that
while enabling Internet Sharing because I thought I already knew how to use
it; by the time it was causing problems, the problems were too disconnected
from the cause.)</p>

<p>In summary: Internet connection sharing is useful, and the Bluetooth PAN
variant is further useful, but don&#8217;t leave it on when you&#8217;re not using it.</p>

<hr />

<ol>
<li><p>Well, you can share Wi-Fi over Wi-Fi if you have multiple physical Wi-Fi interfaces. My laptop only has the one built-in Wi-Fi interface. It might be worth carrying a cheap additional USB Wi-Fi device for this reason. That would probably be the cheapest reliable solution to this problem. ↩</p></li>
<li><p>At the physical layer, a single Wi-Fi radio can only be tuned to a single channel, but nothing stops it from participating in multiple SSIDs as long as they&#8217;re all on that channel. ↩</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/02/13/troubleshooting-mac-sleep-problems/">Troubleshooting Mac Sleep Problems</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-02-13T00:00:00-08:00" pubdate data-updated="true">Feb 13<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/02/13/troubleshooting-mac-sleep-problems/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Here&#8217;s a useful nugget if you&#8217;re inclined to poke at computers to see how they
work: <code>pmset -g log</code>.</p>

<p>I had a problem where my rMBP would sleep just fine on battery power but <a href="http://blog.metamatt.com/blog/2013/02/13/two-%0Athings-i-didnt-know-about-mac-os-internet-sharing/">not
when plugged into its charger</a>. Even with the lid closed,
and even if I explicitly poked the Sleep button first. This meant my chair got
really warm if I left the computer sitting there plugged in to charge
overnight. (NB: I did have the slider in energy saver preferences set to
sleep:never for AC, but that should only affect sleep-after-idle, not lid-
close or explicit sleep request.)</p>

<p>The command <code>pmset -g log</code> helped me learn that this state, where the computer
is awake with the lid closed and no external display or keyboard is attached,
is called DarkWake and that InternetSharing was the entity requesting that
over sleep.</p>

<p>Now that I know about DarkWake, I&#8217;m curious what the relationship is between
it and <a href="http://support.apple.com/kb/ht5394">PowerNap</a>. On this same rMBP, I
disabled PowerNap because it would occasionally kernel panic when waking from
sleep; I forget how I decided that was PowerNap but it hasn&#8217;t happened since
disabling.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/31/google-default-account-for-multiple-sign-in/">Google Default Account for Multiple Sign In</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-31T00:00:00-08:00" pubdate data-updated="true">Jan 31<span>st</span>, 2013</time>
        
         | <a href="/blog/2013/01/31/google-default-account-for-multiple-sign-in/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Google Accounts allow you to <a href="http://support.google.com/accounts/bin/answer.py?hl=en&amp;answer=1721977">stay signed into multiple accounts at
once</a>,
which is hugely helpful for those of us who have multiple account, but there&#8217;s
one thing that&#8217;s been frustrating me here.</p>

<p>I use the browser address bar (relying heavily on its autocomplete feature) to
do most of my navigation directly from the keyboard. If I want my document
files in Google Docs, I open a new browser tab from the keyboard shortcut,
then type &#8220;docs&#8221; and by that time, autocomplete has already filled in
docs.google.com1,2.</p>

<p>However, I have 3 different Google Accounts that I&#8217;m usually signed into: one
standard personal account (ending in @gmail.com), one GAFYD3 account for my
personal email4, and one GAFYD account for work. If I navigate to
docs.google.com, Google automatically chooses one of the accounts to redirect
to, and at different times on different computers I end up with a different
(seemingly arbitrary) account selected, and if it wasn&#8217;t the right one, it&#8217;s 3
extra clicks in the account switcher to get to the right account.</p>

<p>What&#8217;s controlling its choice? It turns out it&#8217;s the order you sign into the
accounts. If you look closely at the URLs, either by mousing over the links in
the account switcher or by looking at the URL you end up at for gmail but not
for docs5, you&#8217;ll see an &#8220;authuser&#8221; or &#8220;u&#8221; parameter which is a low-valued
integer. It starts at 0 for the first account you sign into, and counts up
from there as you sign into additional accounts.</p>

<p>If you navigate directly to docs.google.com (or mail.google.com, etc), you&#8217;ll
get the account currently associated as authuser 0, which is the first account
you signed into.</p>

<p>For the GAFYD case, Google lets you <a href="http://support.google.com/a/bin/answer.py?hl=en&amp;answer=53340">set up convenient forwarding
addresses</a> for
domains you control, and I&#8217;ve used this to map mail.mydomain.foo and
docs.mydomain.foo to redirect automatically to mail.google.com/a/mydomain.foo
and docs.google.com/a/mydomain.foo. This means that for the two GAFYD domains,
if I want the mail or docs view associated with that account, I go to
docs.mydomain.foo, which in turn means that if I navigate to docs.google.com,
I always want my personal account selected by default.</p>

<p>For me, the solution to get the behavior I wanted boils down to:</p>

<ul>
<li>Sign out (which signs you out of all acocunts)</li>
<li>Sign into the primary account which I want as default (the one ending in gmail.com) first, then sign into the others.</li>
<li>Always use this same signin order in the future.</li>
</ul>


<p>Thanks go to <a href="http://www.linkedin.com/pub/ramesh-dharan/1/13b/8a2">Ramesh</a> for
helping me figure this out.</p>

<hr />

<ol>
<li><p>Google has rebranded Google Docs as Google Drive, and docs.google.com redirects to drive.google.com. I haven&#8217;t retrained my fingers, so I always type &#8220;docs&#8221;, so I&#8217;ll keep using the old name. Both names work fine as described in this post. ↩</p></li>
<li><p>(Everything in this post is true for other Google Accounts services like gmail, as well, but docs is the one I navigate directly to the most frequently, so I&#8217;ll stick with it for the example.) ↩</p></li>
<li><p>Google Apps for Your Domain, back when that was a thing; since rebranded as <a href="http://www.google.com/intl/en/enterprise/apps/business/">Google Apps for Business</a> once they removed the free option. ↩</p></li>
<li><p>Why a separate gmail.com and personal GAFYD account? I&#8217;ve long used the same personal email address at a domain I control, predating Gmail. When Google created Gmail and started tacking many other services onto your Gmail account, becoming Google Accounts, I signed up with a gmail address but didn&#8217;t use it for email, just for Google Accounts. At some point I got tired of running my own email server and dealing with reliability and spam, so I decided to let Google host it via the then-free GAFYD. I could have just forwarded mail from the vanity address to the gmail address without setting up another mailbox, but it seemed simpler to keep them separate. That may have been a mistake. ↩</p></li>
<li><p>The URLs vary by service, so this isn&#8217;t as obvious as it could be. Docs/Drive uses URLs like drive.google.com/?authuser=N in the account switcher, but for a GAFYD account, you actually end up at drive.google.com/a/mydomain.foo. Gmail uses URLs like mail.google.com/u/N, both in the account switcher and where you actually end up, though for a GAFYD account you can also navigate to mail.google.com/a/mydomain.foo (and you&#8217;ll be redirected to mail.google.com/u/N for the correct value of N if you&#8217;re already signed into that account, and to the login page if you&#8217;re not). ↩</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/23/restore-from-backup/">Restore From Backup</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-23T00:00:00-08:00" pubdate data-updated="true">Jan 23<span>rd</span>, 2013</time>
        
         | <a href="/blog/2013/01/23/restore-from-backup/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>The SSD in Vanessa&#8217;s iMac died and needed to be replaced. In theory, this is
pretty simple since we have backups — replace the faulty hardware, restore the
backup, and get on with life.</p>

<p>In reality, it&#8217;s a little more complicated. I suppose these are small
complaints since in the big picture, she didn&#8217;t lose any data. Still.</p>

<p>The way I carried out the restore was to</p>

<ul>
<li>Attach the replacement SSD in an external USB enclosure (the &#8220;drive toaster&#8221;)</li>
<li>Boot off the recovery partition of the failing SSD, which still worked well enough for this purpose (otherwise I would have had to make a bootable USB stick or DVD)</li>
<li>Invoke restore from Time Machine onto the new drive</li>
<li>Power down, open the computer, and install the new SSD in place of the old one. (This is the hard part on a recent iMac, involving taking the screen off with suction cups, and so on.)</li>
</ul>


<p>And we&#8217;re done, right? Not quite. Even after the Time Machine restore, a bunch
of things were wonky:</p>

<ul>
<li>There&#8217;s no recovery partition on the new drive. You&#8217;d think Time Machine would recreate that, too, but it doesn&#8217;t. Internet wisdom says all you need to do is reinstall the current version of Mac OS X over itself and it will automatically recreate the recovery partition; I tried it and that wasn&#8217;t the case. What this means is the next failure will be harder to deal with because I&#8217;ll need alternate boot media; the manual means of creating the recovery partition at this point seem just as hard as dealing with that problem when it arises, so I&#8217;m ignoring it for now.</li>
<li>Legitimate licensed Adobe CreativeSuite apps had their copy protection crap out, and refused to run with scary messages from the licensing subsystem using the word &#8220;catastrophic&#8221;. I called Adobe tech support, and they took 20 minutes to tell me to uninstall and reinstall the apps, which took another 20 minutes but worked.</li>
<li>CrashPlan backups weren&#8217;t running because their software uses Java and Mac OS X ships without Java until you launch an interactive Java app at which point you&#8217;re prompted whether you want to automatically install a Java runtime.</li>
<li>Time Machine backups weren&#8217;t running because who knows why, until I went into System Preferences and manually prodded them to run once, after which they kept running fine automatically.</li>
<li>Mac App Store wasn&#8217;t automatically updating software until I launched it and manually signed in.</li>
</ul>


<p>These problems could have been caused by the hard drive replacement, the
restore from backup, or the OS reinstall; I don&#8217;t really know which. I just
know there was a lot more to getting a working system back than letting Time
Machine restore the files.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/23/google-account-access-from-an-iphone/">Google Account Access From an iPhone</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-23T00:00:00-08:00" pubdate data-updated="true">Jan 23<span>rd</span>, 2013</time>
        
         | <a href="/blog/2013/01/23/google-account-access-from-an-iphone/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Google recently announced that after January 2013, they&#8217;ll be <a href="http://support.google.com/a/bin/answer.py?hl=en&amp;answer=2716936">deprecating EAS
access to
Gmail</a> (and
calendar, and address book) for free customers (addresses ending in
@gmail.com, and free Google Apps accounts). It&#8217;ll still be available for paid
Google Apps customers, and it&#8217;ll keep working for normal customers who are
already using it, but only on their existing devices.</p>

<p>This is bad news because EAS (aka Google Sync) has been and continues to be
the best way to get Google services on an iOS device. In my opinion, iOS +
Google Sync continues to be the best combination of mobile device and cloud
services, but this change makes them work a little less well together.</p>

<p>Google Sync (EAS) is the best way to connect iOS to Google services because</p>

<ul>
<li>One &#8220;account&#8221; (setup step in iOS) handles mail, contacts and calendars.</li>
<li>Until September 2012, this was the only way to sync contacts between iOS and Google.</li>
<li>Mail works better: Push works, and the delete button works the way you&#8217;d expect. (Supposedly both iOS mail client and Gimap mail server support IMAP IDLE, but they disagree on how, or something, because the result doesn&#8217;t work.)</li>
<li>Also, if you enable Google&#8217;s 2-factor authentication, you need to generate fallback &#8220;app-specific&#8221; passwords for all your devices1, and for EAS this is one per device, and without EAS it&#8217;s at least two2.</li>
</ul>


<p>For these reasons, especially the second one, I&#8217;ve been using — and
recommending to friends and family — EAS as the preferred way of connecting to
Google accounts. In fact, I didn&#8217;t even realize that contact sync was now
possible without it (Google just added CardDAV support in September 2012).</p>

<p>Similarly, I&#8217;ve been using — and recommending to friends and family — Google
Apps (Gmail and friends) as my preferred provider for cloud
mail/contacts/calendars. Apple&#8217;s track record for cloud mail services is
spotty; even if iCloud is improving, I just don&#8217;t see the advantage over
Google, especially if you don&#8217;t want to tie yourself to Apple devices
forever3.</p>

<p>That leaves us trying to connect iOS to Google&#8217;s services as best we can.
Which to be fair is pretty good, but losing EAS is a step back4. This speaks
to <a href="http://levelsofdetail.kendeeter.com/post/31926718063/maps">something my friend Ken wrote months
ago</a> (in the
context of the maps kerfuffle):</p>

<blockquote><p>Why is it that two tech giants with best-of-breed tech in different areas
rarely seem to be able to cooperate to produce an awesome product for the
user?</p></blockquote>

<p>This has been a bright spot in this regard, which is getting a little less
bright at the end of January.</p>

<p>Google probably doesn&#8217;t care about keeping free EAS working because, in order
of preference, they&#8217;d like to see</p>

<ul>
<li>You using an Android device to connect to Gmail+friends</li>
<li>You using a (paid) Google Apps for Business account</li>
<li>And for anyone else, using a non-Google device to connect to a free Google account, there are still the open protocols (IMAP for mail, CardDAV and CalDAV for calendar and contacts).</li>
</ul>


<p>Apple may not care about optimizing the Gmail experience for iOS users because</p>

<ul>
<li>They&#8217;d like to see you using iCloud for mail+contacts+calendars</li>
<li>Plus they&#8217;ve already connected you to Google services using EAS, so why should they have to do it again differently.</li>
</ul>


<p>In fairness to Apple, adding a &#8220;Gmail&#8221; account to iOS adds both mail and
calendars (IMAP + CalDAV), and Google only added CardDAV support on the server
side in September 2012 (i.e. after the current iOS release). Maybe, hopefully,
Apple will make iOS &#8220;Gmail&#8221; accounts start supporting calendars via CardDAV in
the next release. In the meantime, you have to do it manually.</p>

<p>I don&#8217;t see any reason why the open-protocol support from iOS to Google
services couldn&#8217;t work just as well as EAS — if one setup step added all 3
protocols, and if push were made to work — but it&#8217;s not the case now.</p>

<hr />

<ol>
<li><p>It&#8217;s too bad that native device clients basically negate the advantage of 2-factor authentication, since they aren&#8217;t compatible and force you to use the fallback mechanism. ↩</p></li>
<li><p>One for the &#8220;Gmail&#8221; account supporting IMAP and CalDAV, and one for the separate CardDAV account you have to add. And I don&#8217;t know whether/how &#8220;app-specific&#8221; password authentication actually works for the Gmail account type, given that it&#8217;s a hybrid of two protocols; it&#8217;s possible that doesn&#8217;t work in which case you would have to avoid the Gmail account type, generate 3 fallback passwords, and set up IMAP and CardDAV and CalDav separately. ↩</p></li>
<li><p>I&#8217;m complaining here about the flaws in the relatively good iOS support for Google services; I suspect that anyone trying to connect to iCloud from Android or Windows apps has it far worse. ↩</p></li>
<li><p>There&#8217;s some irony here in that the best way to connect some Apple software to some Google software is using protocols designed by Microsoft. ↩</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2013/01/09/previewing-markdown-files-from-the-terminal/">Previewing Markdown Files From the Terminal</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-01-09T00:00:00-08:00" pubdate data-updated="true">Jan 9<span>th</span>, 2013</time>
        
         | <a href="/blog/2013/01/09/previewing-markdown-files-from-the-terminal/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I&#8217;ve been wanting a way to preview
<a href="http://daringfireball.net/projects/markdown/">Markdown</a>-formatted text files
from the terminal, ideally via <a href="http://www.greenwoodsoftware.com/less/">less</a>.
Primarily, I think, because Github encourages it, a lot of open source
projects are starting to include a
<a href="https://www.google.com/search?q=+readme.md">README.md</a> instead of a plain old
<a href="http://en.wikipedia.org/wiki/README">README</a>12; these marked-down READMEs are
easy to view in Github&#8217;s web interface but not after (or before) you clone the
repo into your own filesystem.</p>

<p>There&#8217;s <code>zless</code> that can understand compressed files; why not <code>mdless</code> that
can understand Markdown files?</p>

<p>I went looking and stackoverflow came to the rescue with this question and
answer about a <a href="http://stackoverflow.com/a/7603703/275581">less-style markdown viewer for UNIX
systems</a>, suggesting
<a href="http://johnmacfarlane.net/pandoc/">pandoc</a> as the tool to translate from
Markdown format to troff format. The suggested incantation there works for me
under Debian Linux but not under Mac OS X because it relies on <code>man</code>&#8217;s <code>-l</code>
option, which I&#8217;m guessing is a GNU addition not supported by BSD <code>man</code>. I had
to figure out how to duplicate the processing that <code>man -l</code> does, which I knew
involved <code>troff</code> (or <code>groff</code>); it turns out that <code>groff</code> understands a <code>-man</code>
flag which predefines the macros used by manpages. The version using <code>groff</code>
instead of <code>man -l</code> seems more portable (it works fine under Linux as well as
Mac OS X), so that&#8217;s what I&#8217;ll use.</p>

<p>Hence, the following incantation to view a README.md file:</p>

<p><code>pandoc -s -f markdown -t man README.md | groff -T utf8 -man | less</code></p>

<p>Or, a <code>mdless</code> command implemented as a tcsh alias:</p>

<p><code>alias mdless "pandoc -s -f markdown -t man \!* | groff -T utf8 -man | less"</code></p>

<hr />

<ol>
<li><p>As one data point for when this became common, README.md was added to the short list of common readme file names in this Wikipedia article on <a href="http://en.wikipedia.org/w/index.php?title=README&amp;oldid=480712255">March 7, 2012</a>. ↩</p></li>
<li><p>Not to be confused with <a href="http://www.amazon.com/gp/product/0062191497/ref=as_li_qf_sp_asin_il_tl?ie=UTF8&amp;tag=metamatt-20&amp;linkCode=as2&amp;camp=1789&amp;creative=9325&amp;creativeASIN=0062191497">REAMDE</a>. ↩</p></li>
</ol>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2012/12/27/mac-boot-drive-selection-from-bluetooth-keyboard/">Mac Boot Drive Selection From Bluetooth Keyboard</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2012-12-27T00:00:00-08:00" pubdate data-updated="true">Dec 27<span>th</span>, 2012</time>
        
         | <a href="/blog/2012/12/27/mac-boot-drive-selection-from-bluetooth-keyboard/#disqus_thread">Comments</a>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Twice in the last few months1 I&#8217;ve had to do troubleshooting steps on
Vanessa&#8217;s iMac that involved booting from alternate volumes2. This is normally
easy on a Mac, but not quite so easy on a Mac with a wireless Bluetooth
keyboard3.</p>

<p>Both times, it was an exercise in frustration, as I give the reboot command
and wait about 10 seconds for the reboot to actually happen; then I hold
Command-R, watch the screen blink black, wait, watch it blink white, wait,
chime, wait, Apple logo, wait, and… oh hello, login screen! That&#8217;s not right.
I&#8217;ve just wasted a minute and I&#8217;m back where I started.</p>

<p>Apple&#8217;s <a href="http://support.apple.com/kb/HT4718">support document on recovery
mode</a> makes it sound so easy:</p>

<blockquote><p>Restart your Mac and hold down the Command key and the R key (Command-R),
and keep holding them until the Apple icon appears, indicating that your Mac
is starting up. After the Recovery System is finished starting up, you should
see a desktop with a OS X menu bar and a &#8220;Mac OS X Utilities&#8221; application
window. Note: If you see a login window or your own desktop and icons, it is
possible that you didn&#8217;t hold Command-R early enough. Restart and try again.</p></blockquote>

<p>After reading and rereading that, I try a few more times, holding Command-R
earlier and earlier as Apple recommends, and, no luck. Wait a minute, I&#8217;m
using a Bluetooth keyboard. Does that cause complications, like, the computer
and keyboard aren&#8217;t able to communicate right at the beginning of the boot
process? Yes4. Do I need to go find a USB keyboard to plug in? Not quite.</p>

<p>It turns out the magic answer is to reboot the computer, wait for the LED on
the keyboard to flash (which is after the computer starts booting and chimes
and does a self-test which on this iMac with 12GB of memory all takes about 20
seconds), and <em>then</em> immediately press and hold Command-R. Any earlier than
that, and you&#8217;ll be ignored.</p>

<p>You&#8217;d think Apple&#8217;s help docs could mention this, since they&#8217;ve been shipping
Bluetooth keyboards by default with all their desktop machines for years now.</p>

<hr />

<ol>
<li><p>Both of these occasions involved disk failures in the <a href="http://blog.metamatt.com/blog/2012/01/20/nothing-is-as-easy-as-it-should-be-ssd-upgrades/">Crucial M4 SSD I installed a year ago</a>. You can probably guess that I&#8217;m not quite as happy with these as I wanted to be. ↩</p></li>
<li><p><a href="http://support.apple.com/kb/HT1533">Booting from CD</a> to upgrade firmware, or <a href="http://support.apple.com/kb/HT4718">booting from the recovery partition</a> to attempt disk repair. Each of these requires holding a certain key down while the computer is booting. ↩</p></li>
<li><p>I put the same SSD model in my own computer, a Mac Pro tower with easily accessible drive bays and an old-school wired keyboard. It&#8217;s a lot easier to troubleshoot and a lot easier to repair. Murphy&#8217;s Law dictates that if we&#8217;re going to have problems with one SSD, it&#8217;ll be the one <a href="http://www.ifixit.com/Guide/iMac+Intel+27-Inch+EMC+2309+and+2374+Hard+Drive+Replacement/1634/1">tucked away under the glass front of the iMac</a>. ↩</p></li>
<li><p>Try googling for &#8221;<a href="https://www.google.com/search?q=boot+mac+from+cd">boot Mac from CD</a>&#8221; versus &#8221;<a href="https://www.google.com/search?q=boot+mac+from+cd+bluetooth">boot Mac from CD bluetooth</a>&#8221;. Big difference. The first one leads you to a simple answer (but deceptively simple in the case you have a Bluetooth keyboard); the second one leads you through a muddle of hundreds of confused people. ↩</p></li>
</ol>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/2/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/02/25/os-x-has-a-builtin-wi-fi-network-scanner/">OS X has a builtin Wi-Fi network scanner</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/25/a-waterproof-tablet-a-step-in-in-the-right-direction/">A waterproof tablet! A step in in the right direction</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/21/speedy-resume/">Speedy resume</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/13/two-things-i-didnt-know-about-mac-os-internet-sharing/">Two things I didn&#8217;t know about Mac OS internet sharing</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/13/troubleshooting-mac-sleep-problems/">Troubleshooting Mac sleep problems</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  
  <a href="https://github.com/metamatt">@metamatt</a> on GitHub
  
  <script type="text/javascript">
    $.domReady(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'metamatt',
            count: 0,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("metamatt", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/metamatt" class="twitter-follow-button" data-show-count="false">Follow @metamatt</a>
  
</section>



<section class="googleplus">
  <h1>
    <a href="https://plus.google.com/117348958487049022391?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>



  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Matt Ginzton -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'metamatt';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
